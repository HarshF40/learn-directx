#include "WindowsMessageMap.h"
#include<windows.h>
#include<string>
#include<sstream>
#include<iomanip>

//secret messages
#define WM_UAHDESTROYWINODW 0x0090
#define WM_UAHDRAWMENU 0X0091
#define WM_UAHDRAWMENUITEM 0x0092
#define WM_UAHDRAWINITMENU 0x0093
#define WM_UAHMEASUREMENUITEM 0x0094
#define WM_UAHNPAINTMENUPOPUP 0x0095

//function like macro
#define REGISTER_PAIR(msg) {msg,#msg}

WindowsMessageMap::WindowsMessageMap() : map({
	REGISTER_PAIR(WM_NULL),
	REGISTER_PAIR(WM_CREATE),
	REGISTER_PAIR(WM_DESTROY),
	REGISTER_PAIR(WM_MOVE),
	REGISTER_PAIR(WM_SIZE),
	REGISTER_PAIR(WM_ACTIVATE),
	REGISTER_PAIR(WM_SETFOCUS),
	REGISTER_PAIR(WM_KILLFOCUS),
	REGISTER_PAIR(WM_ENABLE),
	REGISTER_PAIR(WM_SETREDRAW),
	REGISTER_PAIR(WM_SETTEXT),
	REGISTER_PAIR(WM_GETTEXT),
	REGISTER_PAIR(WM_GETTEXTLENGTH),
	REGISTER_PAIR(WM_PAINT),
	REGISTER_PAIR(WM_CLOSE),
	REGISTER_PAIR(WM_QUERYENDSESSION),
	REGISTER_PAIR(WM_QUIT),
	REGISTER_PAIR(WM_QUERYOPEN),
	REGISTER_PAIR(WM_ERASEBKGND),
	REGISTER_PAIR(WM_SYSCOLORCHANGE),
	REGISTER_PAIR(WM_ENDSESSION),
	REGISTER_PAIR(WM_SHOWWINDOW),
	REGISTER_PAIR(WM_WININICHANGE),
	REGISTER_PAIR(WM_DEVMODECHANGE),
	REGISTER_PAIR(WM_ACTIVATEAPP),
	REGISTER_PAIR(WM_FONTCHANGE),
	REGISTER_PAIR(WM_TIMECHANGE),
	REGISTER_PAIR(WM_CANCELMODE),
	REGISTER_PAIR(WM_SETCURSOR),
	REGISTER_PAIR(WM_MOUSEACTIVATE),
	REGISTER_PAIR(WM_CHILDACTIVATE),
	REGISTER_PAIR(WM_QUEUESYNC),
	REGISTER_PAIR(WM_GETMINMAXINFO),
	REGISTER_PAIR(WM_PAINTICON),
	REGISTER_PAIR(WM_ICONERASEBKGND),
	REGISTER_PAIR(WM_NEXTDLGCTL),
	REGISTER_PAIR(WM_SPOOLERSTATUS),
	REGISTER_PAIR(WM_DRAWITEM),
	REGISTER_PAIR(WM_MEASUREITEM),
	REGISTER_PAIR(WM_DELETEITEM),
	REGISTER_PAIR(WM_VKEYTOITEM),
	REGISTER_PAIR(WM_CHARTOITEM),
	REGISTER_PAIR(WM_SETFONT),
	REGISTER_PAIR(WM_GETFONT),
	REGISTER_PAIR(WM_SETHOTKEY),
	REGISTER_PAIR(WM_GETHOTKEY),
	REGISTER_PAIR(WM_QUERYDRAGICON),
	REGISTER_PAIR(WM_COMPAREITEM),
	REGISTER_PAIR(WM_GETOBJECT),
	REGISTER_PAIR(WM_COMPACTING),
	REGISTER_PAIR(WM_COMMNOTIFY),
	REGISTER_PAIR(WM_WINDOWPOSCHANGING),
	REGISTER_PAIR(WM_WINDOWPOSCHANGED),
	REGISTER_PAIR(WM_POWER),
	REGISTER_PAIR(WM_COPYDATA),
	REGISTER_PAIR(WM_CANCELJOURNAL),
	REGISTER_PAIR(WM_NOTIFY),
	REGISTER_PAIR(WM_INPUTLANGCHANGEREQUEST),
	REGISTER_PAIR(WM_INPUTLANGCHANGE),
	REGISTER_PAIR(WM_TCARD),
	REGISTER_PAIR(WM_HELP),
	REGISTER_PAIR(WM_USERCHANGED),
	REGISTER_PAIR(WM_NOTIFYFORMAT),
	REGISTER_PAIR(WM_CONTEXTMENU),
	REGISTER_PAIR(WM_STYLECHANGING),
	REGISTER_PAIR(WM_STYLECHANGED),
	REGISTER_PAIR(WM_DISPLAYCHANGE),
	REGISTER_PAIR(WM_GETICON),
	REGISTER_PAIR(WM_SETICON),
	REGISTER_PAIR(WM_NCCREATE),
	REGISTER_PAIR(WM_NCDESTROY),
	REGISTER_PAIR(WM_NCCALCSIZE),
	REGISTER_PAIR(WM_NCHITTEST),
	REGISTER_PAIR(WM_NCPAINT),
	REGISTER_PAIR(WM_NCACTIVATE),
	REGISTER_PAIR(WM_GETDLGCODE),
	REGISTER_PAIR(WM_SYNCPAINT),
	REGISTER_PAIR(WM_NCMOUSEMOVE),
	REGISTER_PAIR(WM_NCLBUTTONDOWN),
	REGISTER_PAIR(WM_NCLBUTTONUP),
	REGISTER_PAIR(WM_NCLBUTTONDBLCLK),
	REGISTER_PAIR(WM_NCRBUTTONDOWN),
	REGISTER_PAIR(WM_NCRBUTTONUP),
	REGISTER_PAIR(WM_NCRBUTTONDBLCLK),
	REGISTER_PAIR(WM_NCMBUTTONDOWN),
	REGISTER_PAIR(WM_NCMBUTTONUP),
	REGISTER_PAIR(WM_NCMBUTTONDBLCLK),
	REGISTER_PAIR(WM_NCXBUTTONDOWN),
	REGISTER_PAIR(WM_NCXBUTTONUP),
	REGISTER_PAIR(WM_NCXBUTTONDBLCLK),
	REGISTER_PAIR(EM_GETSEL),
	REGISTER_PAIR(EM_SETSEL),
	REGISTER_PAIR(EM_GETRECT),
	REGISTER_PAIR(EM_SETRECT),
	REGISTER_PAIR(EM_SETRECTNP),
	REGISTER_PAIR(EM_SCROLL),
	REGISTER_PAIR(EM_LINESCROLL),
	REGISTER_PAIR(EM_SCROLLCARET),
	REGISTER_PAIR(EM_GETMODIFY),
	REGISTER_PAIR(EM_SETMODIFY),
	REGISTER_PAIR(EM_GETLINECOUNT),
	REGISTER_PAIR(EM_LINEINDEX),
	REGISTER_PAIR(EM_SETHANDLE),
	REGISTER_PAIR(EM_GETHANDLE),
	REGISTER_PAIR(EM_GETTHUMB),
	REGISTER_PAIR(EM_LINELENGTH),
	REGISTER_PAIR(EM_REPLACESEL),
	REGISTER_PAIR(EM_GETLINE),
	REGISTER_PAIR(EM_LIMITTEXT),
	REGISTER_PAIR(EM_SETLIMITTEXT),
	REGISTER_PAIR(EM_CANUNDO),
	REGISTER_PAIR(EM_UNDO),
	REGISTER_PAIR(EM_FMTLINES),
	REGISTER_PAIR(EM_LINEFROMCHAR),
	REGISTER_PAIR(EM_SETTABSTOPS),
	REGISTER_PAIR(EM_SETPASSWORDCHAR),
	REGISTER_PAIR(EM_EMPTYUNDOBUFFER),
	REGISTER_PAIR(EM_GETFIRSTVISIBLELINE),
	REGISTER_PAIR(EM_SETREADONLY),
	REGISTER_PAIR(EM_SETWORDBREAKPROC),
	REGISTER_PAIR(EM_GETWORDBREAKPROC),
	REGISTER_PAIR(EM_GETPASSWORDCHAR),
	REGISTER_PAIR(EM_SETMARGINS),
	REGISTER_PAIR(EM_GETMARGINS),
	REGISTER_PAIR(EM_GETLIMITTEXT),
	REGISTER_PAIR(EM_POSFROMCHAR),
	REGISTER_PAIR(EM_CHARFROMPOS),
	REGISTER_PAIR(EM_SETIMESTATUS),
	REGISTER_PAIR(EM_GETIMESTATUS),
	REGISTER_PAIR(SBM_SETPOS),
	REGISTER_PAIR(SBM_GETPOS),
	REGISTER_PAIR(SBM_SETRANGE),
	REGISTER_PAIR(SBM_GETRANGE),
	REGISTER_PAIR(SBM_ENABLE_ARROWS),
	REGISTER_PAIR(SBM_SETRANGEREDRAW),
	REGISTER_PAIR(SBM_SETSCROLLINFO),
	REGISTER_PAIR(SBM_GETSCROLLINFO),
	REGISTER_PAIR(SBM_GETSCROLLBARINFO),
	REGISTER_PAIR(BM_GETCHECK),
	REGISTER_PAIR(BM_SETCHECK),
	REGISTER_PAIR(BM_GETSTATE),
	REGISTER_PAIR(BM_SETSTATE),
	REGISTER_PAIR(BM_SETSTYLE),
	REGISTER_PAIR(BM_CLICK),
	REGISTER_PAIR(BM_GETIMAGE),
	REGISTER_PAIR(BM_SETIMAGE),
	REGISTER_PAIR(BM_SETDONTCLICK),
	REGISTER_PAIR(WM_INPUT),
	REGISTER_PAIR(WM_KEYDOWN),
	REGISTER_PAIR(WM_KEYFIRST),
	REGISTER_PAIR(WM_KEYUP),
	REGISTER_PAIR(WM_CHAR),
	REGISTER_PAIR(WM_DEADCHAR),
	REGISTER_PAIR(WM_SYSKEYDOWN),
	REGISTER_PAIR(WM_SYSKEYUP),
	REGISTER_PAIR(WM_SYSCHAR),
	REGISTER_PAIR(WM_SYSDEADCHAR),
	REGISTER_PAIR(WM_UNICHAR / WM_KEYLAST),
	REGISTER_PAIR(WM_IME_STARTCOMPOSITION),
	REGISTER_PAIR(WM_IME_ENDCOMPOSITION),
	REGISTER_PAIR(WM_IME_COMPOSITION),
	REGISTER_PAIR(WM_IME_KEYLAST),
	REGISTER_PAIR(WM_INITDIALOG),
	REGISTER_PAIR(WM_COMMAND),
	REGISTER_PAIR(WM_SYSCOMMAND),
	REGISTER_PAIR(WM_TIMER),
	REGISTER_PAIR(WM_HSCROLL),
	REGISTER_PAIR(WM_VSCROLL),
	REGISTER_PAIR(WM_INITMENU),
	REGISTER_PAIR(WM_INITMENUPOPUP),
	REGISTER_PAIR(WM_MENUSELECT),
	REGISTER_PAIR(WM_MENUCHAR),
	REGISTER_PAIR(WM_ENTERIDLE),
	REGISTER_PAIR(WM_MENURBUTTONUP),
	REGISTER_PAIR(WM_MENUDRAG),
	REGISTER_PAIR(WM_MENUGETOBJECT),
	REGISTER_PAIR(WM_UNINITMENUPOPUP),
	REGISTER_PAIR(WM_MENUCOMMAND),
	REGISTER_PAIR(WM_CHANGEUISTATE),
	REGISTER_PAIR(WM_UPDATEUISTATE),
	REGISTER_PAIR(WM_QUERYUISTATE),
	REGISTER_PAIR(WM_CTLCOLORMSGBOX),
	REGISTER_PAIR(WM_CTLCOLOREDIT),
	REGISTER_PAIR(WM_CTLCOLORLISTBOX),
	REGISTER_PAIR(WM_CTLCOLORBTN),
	REGISTER_PAIR(WM_CTLCOLORDLG),
	REGISTER_PAIR(WM_CTLCOLORSCROLLBAR),
	REGISTER_PAIR(WM_CTLCOLORSTATIC),
	REGISTER_PAIR(CB_GETEDITSEL),
	REGISTER_PAIR(CB_LIMITTEXT),
	REGISTER_PAIR(CB_SETEDITSEL),
	REGISTER_PAIR(CB_ADDSTRING),
	REGISTER_PAIR(CB_DELETESTRING),
	REGISTER_PAIR(CB_DIR),
	REGISTER_PAIR(CB_GETCOUNT),
	REGISTER_PAIR(CB_GETCURSEL),
	REGISTER_PAIR(CB_GETLBTEXT),
	REGISTER_PAIR(CB_GETLBTEXTLEN),
	REGISTER_PAIR(CB_INSERTSTRING),
	REGISTER_PAIR(CB_RESETCONTENT),
	REGISTER_PAIR(CB_FINDSTRING),
	REGISTER_PAIR(CB_SELECTSTRING),
	REGISTER_PAIR(CB_SETCURSEL),
	REGISTER_PAIR(CB_SHOWDROPDOWN),
	REGISTER_PAIR(CB_GETITEMDATA),
	REGISTER_PAIR(CB_SETITEMDATA),
	REGISTER_PAIR(CB_GETDROPPEDCONTROLRECT),
	REGISTER_PAIR(CB_SETITEMHEIGHT),
	REGISTER_PAIR(CB_GETITEMHEIGHT),
	REGISTER_PAIR(CB_SETEXTENDEDUI),
	REGISTER_PAIR(CB_GETEXTENDEDUI),
	REGISTER_PAIR(CB_GETDROPPEDSTATE),
	REGISTER_PAIR(CB_FINDSTRINGEXACT),
	REGISTER_PAIR(CB_SETLOCALE),
	REGISTER_PAIR(CB_GETLOCALE),
	REGISTER_PAIR(CB_GETTOPINDEX),
	REGISTER_PAIR(CB_SETTOPINDEX),
	REGISTER_PAIR(CB_GETHORIZONTALEXTENT),
	REGISTER_PAIR(CB_SETHORIZONTALEXTENT),
	REGISTER_PAIR(CB_GETDROPPEDWIDTH),
	REGISTER_PAIR(CB_SETDROPPEDWIDTH),
	REGISTER_PAIR(CB_INITSTORAGE),
	REGISTER_PAIR(CB_GETCOMBOBOXINFO),
	REGISTER_PAIR(CB_MSGMAX),
	REGISTER_PAIR(WM_MOUSEFIRST),
	REGISTER_PAIR(WM_MOUSEMOVE),
	REGISTER_PAIR(WM_LBUTTONDOWN),
	REGISTER_PAIR(WM_LBUTTONUP),
	REGISTER_PAIR(WM_LBUTTONDBLCLK),
	REGISTER_PAIR(WM_RBUTTONDOWN),
	REGISTER_PAIR(WM_RBUTTONUP),
	REGISTER_PAIR(WM_RBUTTONDBLCLK),
	REGISTER_PAIR(WM_MBUTTONDOWN),
	REGISTER_PAIR(WM_MBUTTONUP),
	REGISTER_PAIR(WM_MBUTTONDBLCLK),
	REGISTER_PAIR(WM_MOUSELAST),
	REGISTER_PAIR(WM_MOUSEWHEEL),
	REGISTER_PAIR(WM_XBUTTONDOWN),
	REGISTER_PAIR(WM_XBUTTONUP),
	REGISTER_PAIR(WM_XBUTTONDBLCLK),
	REGISTER_PAIR(WM_MOUSEHWHEEL),
	REGISTER_PAIR(WM_PARENTNOTIFY),
	REGISTER_PAIR(WM_ENTERMENULOOP),
	REGISTER_PAIR(WM_EXITMENULOOP),
	REGISTER_PAIR(WM_NEXTMENU),
	REGISTER_PAIR(WM_SIZING),
	REGISTER_PAIR(WM_CAPTURECHANGED),
	REGISTER_PAIR(WM_MOVING),
	REGISTER_PAIR(WM_POWERBROADCAST),
	REGISTER_PAIR(WM_DEVICECHANGE),
	REGISTER_PAIR(WM_MDICREATE),
	REGISTER_PAIR(WM_MDIDESTROY),
	REGISTER_PAIR(WM_MDIACTIVATE),
	REGISTER_PAIR(WM_MDIRESTORE),
	REGISTER_PAIR(WM_MDINEXT),
	REGISTER_PAIR(WM_MDIMAXIMIZE),
	REGISTER_PAIR(WM_MDITILE),
	REGISTER_PAIR(WM_MDICASCADE),
	REGISTER_PAIR(WM_MDIICONARRANGE),
	REGISTER_PAIR(WM_MDIGETACTIVE),
	REGISTER_PAIR(WM_MDISETMENU),
	REGISTER_PAIR(WM_ENTERSIZEMOVE),
	REGISTER_PAIR(WM_EXITSIZEMOVE),
	REGISTER_PAIR(WM_DROPFILES),
	REGISTER_PAIR(WM_MDIREFRESHMENU),
	REGISTER_PAIR(WM_IME_SETCONTEXT),
	REGISTER_PAIR(WM_IME_NOTIFY),
	REGISTER_PAIR(WM_IME_CONTROL),
	REGISTER_PAIR(WM_IME_COMPOSITIONFULL),
	REGISTER_PAIR(WM_IME_SELECT),
	REGISTER_PAIR(WM_IME_CHAR),
	REGISTER_PAIR(WM_IME_REQUEST),
	REGISTER_PAIR(WM_IME_KEYDOWN),
	REGISTER_PAIR(WM_IME_KEYUP),
	REGISTER_PAIR(WM_NCMOUSEHOVER),
	REGISTER_PAIR(WM_MOUSEHOVER),
	REGISTER_PAIR(WM_NCMOUSELEAVE),
	REGISTER_PAIR(WM_MOUSELEAVE),
	REGISTER_PAIR(WM_TABLET_FIRST),
	REGISTER_PAIR(WM_TABLET_LAST),
	REGISTER_PAIR(WM_CUT),
	REGISTER_PAIR(WM_COPY),
	REGISTER_PAIR(WM_PASTE),
	REGISTER_PAIR(WM_CLEAR),
	REGISTER_PAIR(WM_UNDO),
	REGISTER_PAIR(WM_RENDERFORMAT),
	REGISTER_PAIR(WM_RENDERALLFORMATS),
	REGISTER_PAIR(WM_DESTROYCLIPBOARD),
	REGISTER_PAIR(WM_DRAWCLIPBOARD),
	REGISTER_PAIR(WM_PAINTCLIPBOARD),
	REGISTER_PAIR(WM_VSCROLLCLIPBOARD),
	REGISTER_PAIR(WM_SIZECLIPBOARD),
	REGISTER_PAIR(WM_ASKCBFORMATNAME),
	REGISTER_PAIR(WM_CHANGECBCHAIN),
	REGISTER_PAIR(WM_HSCROLLCLIPBOARD),
	REGISTER_PAIR(WM_QUERYNEWPALETTE),
	REGISTER_PAIR(WM_PALETTEISCHANGING),
	REGISTER_PAIR(WM_PALETTECHANGED),
	REGISTER_PAIR(WM_HOTKEY),
	REGISTER_PAIR(WM_PRINT),
	REGISTER_PAIR(WM_PRINTCLIENT),
	REGISTER_PAIR(WM_APPCOMMAND),
	REGISTER_PAIR(WM_HANDHELDFIRST),
	REGISTER_PAIR(WM_HANDHELDLAST),
	REGISTER_PAIR(WM_AFXFIRST),
	REGISTER_PAIR(WM_AFXLAST),
	REGISTER_PAIR(WM_PENWINFIRST),
	REGISTER_PAIR(WM_PENWINLAST),
	REGISTER_PAIR(DM_GETDEFID),
	REGISTER_PAIR(NIN_SELECT),
	REGISTER_PAIR(WM_PSD_PAGESETUPDLG),
	REGISTER_PAIR(WM_USER),
	REGISTER_PAIR(DM_SETDEFID),
	REGISTER_PAIR(WM_CHOOSEFONT_GETLOGFONT),
	REGISTER_PAIR(WM_PSD_FULLPAGERECT),
	REGISTER_PAIR(DM_REPOSITION),
	REGISTER_PAIR(WM_PSD_MINMARGINRECT),
	REGISTER_PAIR(WM_PSD_MARGINRECT),
	REGISTER_PAIR(WM_PSD_GREEKTEXTRECT),
	REGISTER_PAIR(WM_PSD_ENVSTAMPRECT),
	REGISTER_PAIR(WM_PSD_YAFULLPAGERECT),
	REGISTER_PAIR(CDM_FIRST),
	REGISTER_PAIR(CDM_GETSPEC),
	REGISTER_PAIR(CDM_GETFILEPATH),
	REGISTER_PAIR(PSM_SETCURSEL),
	REGISTER_PAIR(WM_CHOOSEFONT_SETLOGFONT),
	REGISTER_PAIR(CDM_GETFOLDERPATH),
	REGISTER_PAIR(PSM_REMOVEPAGE),
	REGISTER_PAIR(WM_CHOOSEFONT_SETFLAGS),
	REGISTER_PAIR(CDM_GETFOLDERIDLIST),
	REGISTER_PAIR(PSM_ADDPAGE),
	REGISTER_PAIR(CDM_SETCONTROLTEXT),
	REGISTER_PAIR(PSM_CHANGED),
	REGISTER_PAIR(CDM_HIDECONTROL),
	REGISTER_PAIR(PSM_RESTARTWINDOWS),
	REGISTER_PAIR(CDM_SETDEFEXT),
	REGISTER_PAIR(PSM_REBOOTSYSTEM),
	REGISTER_PAIR(PSM_CANCELTOCLOSE),
	REGISTER_PAIR(PSM_QUERYSIBLINGS),
	REGISTER_PAIR(PSM_UNCHANGED),
	REGISTER_PAIR(PSM_APPLY),
	REGISTER_PAIR(PSM_SETTITLEA),
	REGISTER_PAIR(PSM_SETWIZBUTTONS),
	REGISTER_PAIR(PSM_PRESSBUTTON),
	REGISTER_PAIR(PSM_SETCURSELID),
	REGISTER_PAIR(PSM_SETFINISHTEXTA),
	REGISTER_PAIR(PSM_GETTABCONTROL),
	REGISTER_PAIR(PSM_ISDIALOGMESSAGE),
	REGISTER_PAIR(PSM_GETCURRENTPAGEHWND),
	REGISTER_PAIR(PSM_INSERTPAGE),
	REGISTER_PAIR(PSM_SETTITLEW),
	REGISTER_PAIR(PSM_SETFINISHTEXTW),
	REGISTER_PAIR(PSM_SETHEADERTITLEA),
	REGISTER_PAIR(PSM_SETHEADERTITLEW),
	REGISTER_PAIR(PSM_SETHEADERSUBTITLEA),
	REGISTER_PAIR(PSM_SETHEADERSUBTITLEW),
	REGISTER_PAIR(PSM_HWNDTOINDEX),
	REGISTER_PAIR(PSM_INDEXTOHWND),
	REGISTER_PAIR(PSM_PAGETOINDEX),
	REGISTER_PAIR(PSM_INDEXTOPAGE),
	REGISTER_PAIR(PSM_IDTOINDEX),
	REGISTER_PAIR(PSM_INDEXTOID),
	REGISTER_PAIR(PSM_GETRESULT),
	REGISTER_PAIR(PSM_RECALCPAGESIZES),
	REGISTER_PAIR(WM_APP),
    REGISTER_PAIR(WM_UAHDESTROYWINODW),
	REGISTER_PAIR(WM_UAHDRAWMENU),
	REGISTER_PAIR(WM_UAHDRAWMENUITEM),
	REGISTER_PAIR(WM_UAHDRAWINITMENU),
	REGISTER_PAIR(WM_UAHMEASUREMENUITEM),
	REGISTER_PAIR(WM_UAHNPAINTMENUPOPUP)
	}) {}

std::string WindowsMessageMap::operator()(DWORD msg, LPARAM lp, WPARAM wp) const {
	constexpr int firstColWidth = 25;
	const auto i = map.find(msg);

	std::ostringstream oss;
	if (i != map.end()) {
		oss << std::left << std::setw(firstColWidth) << i->second << std::right;
	} else {
		std::ostringstream padss;
		padss << "Unknow Message: 0x" << std::hex << msg;
		oss << std::left << std::setw(firstColWidth) << padss.str() << std::right;
	}
	oss << "	LP: 0x" << std::hex << std::setfill('0') << std::setw(8) << lp;
	oss << "	WP: 0x" << std::hex << std::setfill('0') << std::setw(8) << wp << std::endl;
	return oss.str();
}